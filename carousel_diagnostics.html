<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>轮播图片加载测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .test-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 30px;
        }
        .test-item {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            background-color: #f9f9f9;
        }
        .test-item h3 {
            margin-top: 0;
            color: #555;
        }
        .image-preview {
            width: 100%;
            height: 300px;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ccc;
            margin: 10px 0;
            position: relative;
        }
        .image-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
            font-weight: bold;
        }
        .status.success {
            background-color: #d4edda;
            color: #155724;
        }
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
        }
        .status.loading {
            background-color: #fff3cd;
            color: #856404;
        }
        .logs {
            background-color: #333;
            color: #fff;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            margin-top: 10px;
            max-height: 150px;
            overflow-y: auto;
        }
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .error-message {
            color: #dc3545;
            font-size: 14px;
            margin-top: 5px;
        }
        .alternative-paths {
            margin-top: 10px;
        }
        .alt-path {
            padding: 5px 10px;
            margin-right: 10px;
            margin-bottom: 10px;
            background-color: #e9ecef;
            border-radius: 4px;
            display: inline-block;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .alt-path:hover {
            background-color: #dee2e6;
        }
        .alt-path.success {
            background-color: #d4edda;
            color: #155724;
        }
        .alt-path.error {
            background-color: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <h1>轮播图片加载测试</h1>
    
    <div class="test-container">
        <!-- 图片1测试 -->
        <div class="test-item">
            <h3>图片1: 4141ab88-6dc1-4253-94d8-f4692ab7272f.png</h3>
            <div class="image-preview">
                <div id="spinner1" class="loading-spinner"></div>
                <img id="testImg1" src="" alt="测试图片1" style="display:none;">
            </div>
            <div id="status1" class="status loading">加载中...</div>
            <div class="error-message" id="error1"></div>
            <div class="alternative-paths">
                <strong>尝试其他扩展名:</strong>
                <span class="alt-path" data-img="1" data-ext=".jpg">.jpg</span>
                <span class="alt-path" data-img="1" data-ext=".png">.png</span>
                <span class="alt-path" data-img="1" data-ext=".webp">.webp</span>
                <span class="alt-path" data-img="1" data-ext=".gif">.gif</span>
            </div>
        </div>
        
        <!-- 图片2测试 -->
        <div class="test-item">
            <h3>图片2: 4c97ca9f-75a1-48b3-a48a-b1c609933793.webp</h3>
            <div class="image-preview">
                <div id="spinner2" class="loading-spinner"></div>
                <img id="testImg2" src="" alt="测试图片2" style="display:none;">
            </div>
            <div id="status2" class="status loading">加载中...</div>
            <div class="error-message" id="error2"></div>
            <div class="alternative-paths">
                <strong>尝试其他扩展名:</strong>
                <span class="alt-path" data-img="2" data-ext=".jpg">.jpg</span>
                <span class="alt-path" data-img="2" data-ext=".png">.png</span>
                <span class="alt-path" data-img="2" data-ext=".webp">.webp</span>
                <span class="alt-path" data-img="2" data-ext=".gif">.gif</span>
            </div>
        </div>
        
        <!-- 图片3测试 -->
        <div class="test-item">
            <h3>图片3: 微信图片_20250825105422.png</h3>
            <div class="image-preview">
                <div id="spinner3" class="loading-spinner"></div>
                <img id="testImg3" src="" alt="测试图片3" style="display:none;">
            </div>
            <div id="status3" class="status loading">加载中...</div>
            <div class="error-message" id="error3"></div>
            <div class="alternative-paths">
                <strong>尝试其他扩展名:</strong>
                <span class="alt-path" data-img="3" data-ext=".jpg">.jpg</span>
                <span class="alt-path" data-img="3" data-ext=".png">.png</span>
                <span class="alt-path" data-img="3" data-ext=".webp">.webp</span>
                <span class="alt-path" data-img="3" data-ext=".gif">.gif</span>
            </div>
        </div>
        
        <!-- 简单命名格式测试 -->
        <div class="test-item">
            <h3>简单命名格式测试</h3>
            <div class="image-preview">
                <img id="simpleImg1" src="" alt="简单命名图片1" style="display:none;">
                <img id="simpleImg2" src="" alt="简单命名图片2" style="display:none;">
                <img id="simpleImg3" src="" alt="简单命名图片3" style="display:none;">
            </div>
            <div id="simpleStatus" class="status loading">加载中...</div>
            <div class="error-message" id="simpleError"></div>
            <div class="alternative-paths">
                <span class="alt-path" data-simple="1" data-name="1.jpg">1.jpg</span>
                <span class="alt-path" data-simple="2" data-name="2.jpg">2.jpg</span>
                <span class="alt-path" data-simple="3" data-name="3.jpg">3.jpg</span>
            </div>
        </div>
        
        <!-- 控制台日志 -->
        <div class="test-item">
            <h3>控制台日志</h3>
            <div id="logs" class="logs"></div>
        </div>
    </div>

    <script>
        // 日志函数
        function log(message) {
            const logsDiv = document.getElementById('logs');
            const logEntry = document.createElement('div');
            logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logsDiv.appendChild(logEntry);
            logsDiv.scrollTop = logsDiv.scrollHeight;
            console.log(message);
        }

        // 测试图片加载函数
        function testImageLoading(imgId, placeholderId, statusId, errorId, baseName, basePath = '/images_new/lunbotu/') {
            const img = document.getElementById(imgId);
            const spinner = document.getElementById(placeholderId);
            const status = document.getElementById(statusId);
            const error = document.getElementById(errorId);
            
            const fullPath = basePath + baseName;
            
            log(`开始加载图片: ${fullPath}`);
            
            // 重置状态
            status.className = 'status loading';
            status.textContent = '加载中...';
            error.textContent = '';
            img.style.display = 'none';
            spinner.style.display = 'block';
            
            // 设置图片src
            img.src = fullPath;
            
            // 图片加载成功处理
            img.onload = function() {
                log(`成功: 图片加载完成 - ${fullPath}`);
                status.className = 'status success';
                status.textContent = '加载成功';
                img.style.display = 'block';
                spinner.style.display = 'none';
            };
            
            // 图片加载失败处理
            img.onerror = function() {
                log(`错误: 无法加载图片 - ${fullPath}`);
                status.className = 'status error';
                status.textContent = '加载失败';
                error.textContent = `无法加载图片: ${fullPath}`;
                spinner.style.display = 'none';
            };
        }

        // 尝试替代扩展名
        document.querySelectorAll('.alt-path[data-img]').forEach(btn => {
            btn.addEventListener('click', function() {
                const imgNum = this.getAttribute('data-img');
                const ext = this.getAttribute('data-ext');
                const baseNames = [
                    '4141ab88-6dc1-4253-94d8-f4692ab7272f',
                    '4c97ca9f-75a1-48b3-a48a-b1c609933793',
                    '微信图片_20250825105422'
                ];
                
                const baseName = baseNames[imgNum - 1] + ext;
                log(`尝试替代扩展名: ${baseName}`);
                
                // 禁用所有同组按钮
                document.querySelectorAll(`.alt-path[data-img="${imgNum}"]`).forEach(b => {
                    b.classList.remove('success', 'error');
                });
                
                // 创建临时图片对象测试路径
                const tempImg = new Image();
                tempImg.onload = () => {
                    log(`成功: 替代路径有效 - ${baseName}`);
                    btn.classList.add('success');
                    // 更新主图片
                    testImageLoading(`testImg${imgNum}`, `spinner${imgNum}`, `status${imgNum}`, `error${imgNum}`, baseName);
                };
                tempImg.onerror = () => {
                    log(`失败: 替代路径无效 - ${baseName}`);
                    btn.classList.add('error');
                };
                tempImg.src = '/images_new/lunbotu/' + baseName;
            });
        });

        // 测试简单命名格式
        document.querySelectorAll('.alt-path[data-simple]').forEach(btn => {
            btn.addEventListener('click', function() {
                const imgNum = this.getAttribute('data-simple');
                const name = this.getAttribute('data-name');
                log(`尝试简单命名格式: ${name}`);
                
                // 重置所有简单命名图片
                document.querySelectorAll('[id^="simpleImg"]').forEach(img => {
                    img.style.display = 'none';
                });
                
                // 禁用所有简单命名按钮
                document.querySelectorAll('.alt-path[data-simple]').forEach(b => {
                    b.classList.remove('success', 'error');
                });
                
                const simpleImg = document.getElementById(`simpleImg${imgNum}`);
                const simpleStatus = document.getElementById('simpleStatus');
                const simpleError = document.getElementById('simpleError');
                
                simpleStatus.className = 'status loading';
                simpleStatus.textContent = '加载中...';
                simpleError.textContent = '';
                
                simpleImg.src = '/images_new/lunbotu/' + name;
                
                simpleImg.onload = function() {
                    log(`成功: 简单命名图片加载完成 - ${name}`);
                    btn.classList.add('success');
                    simpleStatus.className = 'status success';
                    simpleStatus.textContent = `加载成功: ${name}`;
                    simpleImg.style.display = 'block';
                };
                
                simpleImg.onerror = function() {
                    log(`错误: 简单命名图片加载失败 - ${name}`);
                    btn.classList.add('error');
                    simpleStatus.className = 'status error';
                    simpleStatus.textContent = '加载失败';
                    simpleError.textContent = `无法加载图片: ${name}`;
                };
            });
        });

        // 页面加载完成后开始测试
        window.onload = function() {
            log('页面加载完成，开始测试轮播图片...');
            
            // 测试所有图片
            testImageLoading('testImg1', 'spinner1', 'status1', 'error1', '4141ab88-6dc1-4253-94d8-f4692ab7272f.png');
            
            // 延迟测试第二张图片
            setTimeout(() => {
                testImageLoading('testImg2', 'spinner2', 'status2', 'error2', '4c97ca9f-75a1-48b3-a48a-b1c609933793.webp');
            }, 500);
            
            // 延迟测试第三张图片
            setTimeout(() => {
                testImageLoading('testImg3', 'spinner3', 'status3', 'error3', '微信图片_20250825105422.png');
            }, 1000);
        };
    </script>
</body>
</html>