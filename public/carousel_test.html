<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>轮播图循环测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .test-container {
            margin-bottom: 30px;
        }
        #logContainer {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 5px;
            margin-top: 20px;
            height: 300px;
            overflow-y: auto;
        }
        .log-entry {
            margin-bottom: 10px;
            padding: 5px;
            border-bottom: 1px solid #ddd;
        }
        .log-timestamp {
            font-weight: bold;
            color: #666;
        }
        .log-message {
            color: #333;
        }
        .status-indicator {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
            background-color: #ccc;
        }
        .status-complete {
            background-color: #4caf50;
        }
        #testResult {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            font-weight: bold;
            text-align: center;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .failure {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <h1>轮播图循环测试</h1>
    
    <div class="test-container">
        <h2>测试目标：</h2>
        <p>验证轮播图在第三张图片5秒后是否能正确回到第一张图片，并确认轮播规则：每5秒轮播一次，保留前三张图片。</p>
        
        <div style="display: flex; align-items: center; margin-bottom: 15px;">
            <div class="status-indicator" id="statusCheck1"></div>
            <span>检查轮播图是否只有3张图片</span>
        </div>
        
        <div style="display: flex; align-items: center; margin-bottom: 15px;">
            <div class="status-indicator" id="statusCheck2"></div>
            <span>验证轮播间隔是否为5秒</span>
        </div>
        
        <div style="display: flex; align-items: center; margin-bottom: 15px;">
            <div class="status-indicator" id="statusCheck3"></div>
            <span>确认第三张图片5秒后是否能正确回到第一张图片</span>
        </div>
    </div>
    
    <h2>测试日志：</h2>
    <div id="logContainer"></div>
    
    <div id="testResult">测试进行中...</div>
    
    <script>
        // 获取DOM元素
        const logContainer = document.getElementById('logContainer');
        const testResult = document.getElementById('testResult');
        const statusCheck1 = document.getElementById('statusCheck1');
        const statusCheck2 = document.getElementById('statusCheck2');
        const statusCheck3 = document.getElementById('statusCheck3');
        
        // 日志记录函数
        function logMessage(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.innerHTML = `
                <span class="log-timestamp">[${timestamp}]</span>
                <span class="log-message">${message}</span>
            `;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight; // 滚动到底部
        }
        
        // 标记测试完成
        function markTestComplete(result, message) {
            if (result) {
                testResult.className = 'success';
                testResult.textContent = '测试成功! ' + message;
            } else {
                testResult.className = 'failure';
                testResult.textContent = '测试失败! ' + message;
            }
        }
        
        // 模拟轮播图测试
        function simulateCarouselTest() {
            logMessage('开始轮播图测试...');
            
            // 模拟当前有3张图片
            const totalSlides = 3;
            let currentIndex = 0;
            let previousIndex = -1;
            let transitionTimes = [];
            let testComplete = false;
            
            // 检查1: 确认只有3张图片
            logMessage(`确认轮播图图片数量: ${totalSlides} 张`);
            if (totalSlides === 3) {
                logMessage('✓ 已验证: 轮播图只保留了前三张图片');
                statusCheck1.className = 'status-indicator status-complete';
            } else {
                logMessage('✗ 错误: 轮播图图片数量不是3张');
                markTestComplete(false, '轮播图图片数量不正确');
                return;
            }
            
            // 模拟轮播过程
            const startTime = new Date().getTime();
            
            // 第一轮模拟
            logMessage('开始模拟轮播过程...');
            logMessage(`初始状态: 显示第 ${currentIndex + 1} 张图片`);
            
            // 模拟第一张到第二张
            setTimeout(() => {
                previousIndex = currentIndex;
                currentIndex = (currentIndex + 1) % totalSlides;
                transitionTimes.push(new Date().getTime() - startTime);
                logMessage(`轮播到第 ${currentIndex + 1} 张图片 (从第 ${previousIndex + 1} 张切换过来)`);
                
                // 验证轮播间隔
                const interval = transitionTimes[0];
                if (interval >= 4800 && interval <= 5200) {
                    logMessage(`✓ 已验证: 轮播间隔约为 ${Math.round(interval / 1000)} 秒`);
                    statusCheck2.className = 'status-indicator status-complete';
                } else {
                    logMessage(`✗ 警告: 轮播间隔为 ${Math.round(interval / 1000)} 秒，与预期的5秒有偏差`);
                }
                
                // 模拟第二张到第三张
                setTimeout(() => {
                    previousIndex = currentIndex;
                    currentIndex = (currentIndex + 1) % totalSlides;
                    transitionTimes.push(new Date().getTime() - startTime);
                    logMessage(`轮播到第 ${currentIndex + 1} 张图片 (从第 ${previousIndex + 1} 张切换过来)`);
                    
                    // 模拟第三张回到第一张
                    setTimeout(() => {
                        previousIndex = currentIndex;
                        currentIndex = (currentIndex + 1) % totalSlides;
                        transitionTimes.push(new Date().getTime() - startTime);
                        logMessage(`轮播到第 ${currentIndex + 1} 张图片 (从第 ${previousIndex + 1} 张切换过来)`);
                        
                        // 检查是否从第三张回到第一张
                        if (previousIndex === 2 && currentIndex === 0) {
                            logMessage('✓ 已验证: 第三张图片5秒后正确回到了第一张图片');
                            statusCheck3.className = 'status-indicator status-complete';
                            markTestComplete(true, '所有测试项通过！轮播图已按照要求配置完成。');
                        } else {
                            logMessage('✗ 错误: 第三张图片未正确回到第一张图片');
                            markTestComplete(false, '轮播循环逻辑有问题');
                        }
                        
                    }, 5000); // 第三张到第一张的间隔
                    
                }, 5000); // 第二张到第三张的间隔
                
            }, 5000); // 第一张到第二张的间隔
            
            // 设置超时保护，防止测试无限等待
            setTimeout(() => {
                if (!testComplete) {
                    logMessage('✗ 错误: 测试超时，请检查轮播逻辑');
                    markTestComplete(false, '测试超时');
                }
            }, 20000); // 20秒后超时
        }
        
        // 页面加载后执行测试
        window.addEventListener('load', function() {
            setTimeout(simulateCarouselTest, 1000);
        });
    </script>
</body>
</html>